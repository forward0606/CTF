from pwn import *
import math
from Crypto.Util.number import inverse

r = remote('134.209.237.231', 4242, level='debug')

r.sendline('challenge')

r.recvuntil('Problem:')

s = r.recvline()
s = s.split(b',')
s = [int(x) for x in s]
m = 0
for i in range(3, len(s)):
    x0 = s[i-3]
    x1 = s[i-2]
    x2 = s[i-1]
    x3 = s[i]
    tmp = (x1-x0)*(x3-x2) - (x2-x1) * (x2-x1)
    if i == 3:
        m = tmp
    else:
        m = math.gcd(m, tmp)
a = (s[2] - s[1]) * inverse(s[1] - s[0], m) % m
c = (s[1] - a * s[0]) % m

nonce = (s[-1] * a + c) % m
r.sendline(str(nonce))
print("s: ", s)
print("m: ", m)
print("a: ", a)
print("c: ", c)
r.interactive()

